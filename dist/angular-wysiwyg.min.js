!function(t,e){"use strict";var a=[["bold","italic","underline","strikethrough","subscript","superscript"],["format-block"],["font"],["font-size"],["font-color","hilite-color"],["remove-format"],["ordered-list","unordered-list","outdent","indent"],["left-justify","center-justify","right-justify"],["code","quote","paragraph"],["link","image"]];t.module("wysiwyg.module",["colorpicker.module"]).directive("wysiwyg",["$timeout","wysiwgGui","$compile",function(a,n,i){function o(o,l,s,r){function u(){c(),m(),f()}function c(){n.setCustomElements(o.textareaCustomMenu);var t=l.find("wysiwyg-menu")[0];t.appendChild(n.createMenu(o.textareaMenu)),i(t)(o)}function m(){o.$watch("disabled",function(e){t.forEach(t.element(l.find("wysiwyg-menu")[0]).find("button"),function(a){t.element(a).attr("disabled",e)}),t.forEach(t.element(l.find("wysiwyg-menu")[0]).find("select"),function(a){t.element(a).attr("disabled",e)})})}function f(){t.element(l.find("wysiwyg-menu")[0]).find("button").on("click",function(){var e=t.element(this);o.$emit("wysiwyg.click",e.attr("title")||e.attr("data-original-title"))}),v.on("input keyup paste mouseup",function(){var t=v.html();"<br>"==t&&(t=""),r.$setViewValue(t)}),v.on("keydown",function(t){if(9==t.keyCode){{var e=(v.html(),window.getSelection());e.anchorOffset}t.preventDefault()}}),v.on("click keyup focus mouseup",function(){a(function(){o.isBold=o.cmdState("bold"),o.isUnderlined=o.cmdState("underline"),o.isStrikethrough=o.cmdState("strikethrough"),o.isItalic=o.cmdState("italic"),o.isSuperscript=d("SUP"),o.isSubscript=d("SUB"),o.isRightJustified=o.cmdState("justifyright"),o.isLeftJustified=o.cmdState("justifyleft"),o.isCenterJustified=o.cmdState("justifycenter"),o.isPre="pre"===o.cmdValue("formatblock"),o.isBlockquote="blockquote"===o.cmdValue("formatblock"),o.isOrderedList=o.cmdState("insertorderedlist"),o.isUnorderedList=o.cmdState("insertunorderedlist"),o.fonts.forEach(function(t){return o.cmdValue("fontname").indexOf(t)>-1?(o.font=t,!1):void 0}),o.cmdValue("formatblock").toLowerCase(),o.formatBlocks.forEach(function(t){return o.cmdValue("formatblock").toLowerCase()===t.value.toLowerCase()?(o.formatBlock=t,!1):void 0}),o.fontSizes.forEach(function(t){return o.cmdValue("fontsize")===t.value?(o.fontSize=t,!1):void 0}),o.hiliteColor=g(),t.element(l[0].querySelector("button.wysiwyg-hilitecolor")).css("background-color",o.hiliteColor),o.fontColor=o.cmdValue("forecolor"),t.element(l[0].querySelector("button.wysiwyg-fontcolor")).css("color",o.fontColor),o.isLink=d("A")},0)})}function d(t){if(window.getSelection().rangeCount<1)return!1;var e=window.getSelection().getRangeAt(0);return e&&(e.startContainer.parentNode.tagName===t.toUpperCase()||e.endContainer.parentNode.tagName===t.toUpperCase())?!0:!1}function g(){if(window.getSelection().rangeCount<1)return!1;var e=window.getSelection().getRangeAt(0);if(e){var a=t.element(e.startContainer.parentNode).attr("style");if(!t.isDefined(a))return!1;for(var n=a.split(";"),i=0;i<n.length;i++){var o=n[i].split(":");if("background-color"===o[0])return o[1]}return"#fff"}return"#fff"}var v=l.find("editor");o.isLink=!1,o.fontSizes=[{value:"1",size:"10px"},{value:"2",size:"13px"},{value:"3",size:"16px"},{value:"4",size:"18px"},{value:"5",size:"24px"},{value:"6",size:"32px"},{value:"7",size:"48px"}],o.formatBlocks=[{name:"Heading Blocks",value:"div"},{name:"Heading 1",value:"h1"},{name:"Heading 2",value:"h2"},{name:"Heading 3",value:"h3"},{name:"Heading 4",value:"h4"},{name:"Heading 5",value:"h5"},{name:"Heading 6",value:"h6"}],o.formatBlock=o.formatBlocks[0],o.fontSize=o.fontSizes[1],t.isArray(o.cssClasses)&&(o.cssClasses.unshift("css"),o.cssClass=o.cssClasses[0]),o.fonts=["Georgia","Palatino Linotype","Times New Roman","Arial","Helvetica","Arial Black","Comic Sans MS","Impact","Lucida Sans Unicode","Tahoma","Trebuchet MS","Verdana","Courier New","Lucida Console","Helvetica Neue"].sort(),o.font=o.fonts[6],u(),r.$render=function(){v.html(r.$viewValue)},o.format=function(t,e){document.execCommand(t,!1,e)},o.cmdState=function(t){return document.queryCommandState(t)},o.cmdValue=function(t){return document.queryCommandValue(t)},o.createLink=function(){if(o.callbacks!==e&&"function"==typeof o.callbacks.link)o.callbacks.link(function(t){t&&t!==e&&o.format("createlink",t)});else{var t=prompt("Enter the link URL");t&&t!==e&&o.format("createlink",t)}},o.insertImage=function(){if(o.callbacks!==e&&"function"==typeof o.callbacks.image)o.callbacks.image(function(t){t&&t!==e&&o.format("insertimage",t)});else{var t=prompt("Enter the image URL");t&&t!==e&&o.format("insertimage",t)}},o.setFont=function(){o.format("fontname",o.font)},o.setFontSize=function(){o.format("fontsize",o.fontSize.value)},o.setFormatBlock=function(){o.format("formatBlock",o.formatBlock.value)},o.setFontColor=function(){o.format("forecolor",o.fontColor)},o.setHiliteColor=function(){o.format("hiliteColor",o.hiliteColor)},o.format("enableObjectResizing",!0),o.format("styleWithCSS",!0)}return{template:'<div><style>   .wysiwyg-textarea[contentEditable="false"] { background-color:#eee}   .wysiwyg-btn-group-margin { margin-right:5px; }   .wysiwyg-select { height:30px;margin-bottom:1px;}   .wysiwyg-colorpicker { font-family: arial, sans-serif !important;font-size:16px !important; padding:2px 10px !important;}</style><wysiwyg-menu></wysiwyg-menu><editor id="{{textareaId}}" ng-attr-style="resize:vertical;height:{{textareaHeight || \'80px\'}}; overflow:auto" contentEditable={{!disabled}} class="{{textareaClass}} wysiwyg-textarea" rows="{{textareaRows}}" name="{{textareaName}}" required="{{textareaRequired}}" placeholder="{{textareaPlaceholder}}" ng-model="value"></editor></div>',restrict:"E",scope:{value:"=ngModel",textareaHeight:"@textareaHeight",textareaName:"@textareaName",textareaClass:"@textareaClass",textareaRequired:"@textareaRequired",textareaId:"@textareaId",textareaMenu:"=textareaMenu",textareaCustomMenu:"=textareaCustomMenu",fn:"&",callbacks:"=callbacks",disabled:"=?disabled"},replace:!0,require:"ngModel",link:o,transclude:!0}}]).factory("wysiwgGui",["wysiwgGuiElements",function(e){function n(t){var e;if(t.tag)e=document.createElement(t.tag);else{if(!t.text)return console.log("cannot create this element."),e=document.createElement("span");e=document.createElement("span")}if(t.text&&document.all?e.innerText=t.text:t.text&&(e.textContent=t.text),t.classes&&(e.className=t.classes),t.html&&(e.innerHTML=t.html),t.attributes&&t.attributes.length)for(var a in t.attributes){var i=t.attributes[a];i.name&&i.value&&e.setAttribute(i.name,i.value)}if(t.data&&t.data.length)for(var o in t.data)e.appendChild(n(t.data[o]));return e}var i=e,o={},l=function(t){o=t},s=function(){return{tag:"div",classes:"btn-group btn-group-sm wysiwyg-btn-group-margin"}},r=function(t){return i[t]||{}},u=function(e){t.extend(i,o),e=t.isDefined(e)&&""!==e?e:a;for(var l,u=document.createElement("div"),c=0;c<e.length;c++){for(var m=n(s()),f=0;f<e[c].length;f++)"link"===e[c][f]&&(l=n(r("unlink")),m.appendChild(l)),l=n(r(e[c][f])),m.appendChild(l);u.appendChild(m)}return u};return{createMenu:u,setCustomElements:l}}]).value("wysiwgGuiElements",{bold:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Bold"},{name:"ng-click",value:"format('bold')"},{name:"ng-class",value:"{ active: isBold }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-bold"}]},italic:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Italic"},{name:"ng-click",value:"format('italic')"},{name:"ng-class",value:"{ active: isItalic }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-italic"}]},underline:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Underline"},{name:"ng-click",value:"format('underline')"},{name:"ng-class",value:"{ active: isUnderlined }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-underline"}]},strikethrough:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Strikethrough"},{name:"ng-click",value:"format('strikethrough')"},{name:"ng-class",value:"{ active: isStrikethrough }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-strikethrough"}]},subscript:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Subscript"},{name:"ng-click",value:"format('subscript')"},{name:"ng-class",value:"{ active: isSubscript }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-subscript"}]},superscript:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Superscript"},{name:"ng-click",value:"format('superscript')"},{name:"ng-class",value:"{ active: isSuperscript }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-superscript"}]},"remove-format":{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Remove Formatting"},{name:"ng-click",value:"format('removeFormat')"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-eraser"}]},"ordered-list":{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Ordered List"},{name:"ng-click",value:"format('insertorderedlist')"},{name:"ng-class",value:"{ active: isOrderedList }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-list-ol"}]},"unordered-list":{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Unordered List"},{name:"ng-click",value:"format('insertunorderedlist')"},{name:"ng-class",value:"{ active: isUnorderedList }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-list-ul"}]},outdent:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Outdent"},{name:"ng-click",value:"format('outdent')"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-outdent"}]},indent:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Indent"},{name:"ng-click",value:"format('indent')"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-indent"}]},"left-justify":{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Left Justify"},{name:"ng-click",value:"format('justifyleft')"},{name:"ng-class",value:"{ active: isLeftJustified }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-align-left"}]},"center-justify":{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Center Justify"},{name:"ng-click",value:"format('justifycenter')"},{name:"ng-class",value:"{ active: isCenterJustified }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-align-center"}]},"right-justify":{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Right Justify"},{name:"ng-click",value:"format('justifyright')"},{name:"ng-class",value:"{ active: isRightJustified }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-align-right"}]},code:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Code"},{name:"ng-click",value:"format('formatblock', 'pre')"},{name:"ng-class",value:"{ active: isPre }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-code"}]},quote:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Quote"},{name:"ng-click",value:"format('formatblock', 'blockquote')"},{name:"ng-class",value:"{ active: isBlockquote }"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-quote-right"}]},paragraph:{tag:"button",classes:"btn btn-default",text:"P",attributes:[{name:"tooltip",value:"Paragragh"},{name:"ng-click",value:"format('insertParagraph')"},{name:"ng-class",value:"{ active: isParagraph }"},{name:"type",value:"button"}]},image:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Image"},{name:"ng-click",value:"insertImage()"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-picture-o"}]},"font-color":{tag:"button",classes:"btn btn-default wysiwyg-colorpicker wysiwyg-fontcolor",text:"A",attributes:[{name:"tooltip",value:"Font Color"},{name:"colorpicker",value:"rgba"},{name:"colorpicker-position",value:"top"},{name:"ng-model",value:"fontColor"},{name:"ng-change",value:"setFontColor()"},{name:"type",value:"button"}]},"hilite-color":{tag:"button",classes:"btn btn-default wysiwyg-colorpicker wysiwyg-hilitecolor",text:"H",attributes:[{name:"tooltip",value:"Hilite Color"},{name:"colorpicker",value:"rgba"},{name:"colorpicker-position",value:"top"},{name:"ng-model",value:"hiliteColor"},{name:"ng-change",value:"setHiliteColor()"},{name:"type",value:"button"}]},font:{tag:"select",classes:"form-control wysiwyg-select",attributes:[{name:"tooltip",value:"Image"},{name:"ng-model",value:"font"},{name:"ng-options",value:"f for f in fonts"},{name:"ng-change",value:"setFont()"}]},"font-size":{tag:"select",classes:"form-control wysiwyg-select",attributes:[{name:"tooltip",value:"Image"},{name:"ng-model",value:"fontSize"},{name:"ng-options",value:"f.size for f in fontSizes"},{name:"ng-change",value:"setFontSize()"}]},"format-block":{tag:"select",classes:"form-control wysiwyg-select",attributes:[{name:"tooltip",value:"Format Block"},{name:"ng-model",value:"formatBlock"},{name:"ng-options",value:"f.name for f in formatBlocks"},{name:"ng-change",value:"setFormatBlock()"}]},link:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Link"},{name:"ng-click",value:"createLink()"},{name:"ng-show",value:"!isLink"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-link"}]},unlink:{tag:"button",classes:"btn btn-default",attributes:[{name:"tooltip",value:"Unlink"},{name:"ng-click",value:"format('unlink')"},{name:"ng-show",value:"isLink"},{name:"type",value:"button"}],data:[{tag:"i",classes:"fa fa-unlink"}]}})}(angular);